---
layout: single
title: "[aws] AWS 파일관리"
excerpt: "AWS S3, EBS, EFS 파일관리 설명"

categories:
  - tech
tags:
  - [aws, s3, ebs, efs]

toc: false
toc_sticky: true

date: 2023-01-31
last_modified_at: 2023-01-31
---

# 1. AWS S3, EBS, EFS 파일관리 설명
  
## 1-1. Amazon Cloud Storage 비교

| 분류   | 특성                                        | S3 (Object)                                                                                    | EFS (File)                                                | EBS (Block)                                       |
|------|-------------------------------------------|------------------------------------------------------------------------------------------------|-----------------------------------------------------------|---------------------------------------------------|
| 퍼포먼스 | 작업별 대기 시간                                 | 낮음, 여러 요청 타입 처리, CloudFront와 통합                                                                | 낮음, 일관됨                                                   | 가장 낮음, 일관됨                                        |
|      | 처리량 크기                                    | 초당 GBs                                                                                         | 초당 GBs                                                    | 초당 GB                                             |
| 특성   | 가용성 / 내구성 <br/>(availability, durability) | 여러 AZ에 중복 저장                                                                                   | 여러 AZ에 중복 저장                                              | 단일 AZ에 중복 저장                                      |
|      | 엑세스                                       | 웹을 통한 수백만 개의 연결                                                                                | 1개~수천개의 EC2인스턴스 / on-premise 서버 / 여러 AZ에서 동시 접근           | 하나의 AZ에 속한 하나의 EC2 인스턴스                           |
|      | EC2 마운트 여부                                | 마운트 불가능                                                                                        | 마운트 가능                                                    | 마운트 가능                                            |
|      | 서비스 AZ제약                                  | AZ 제한 없음                                                                                       | AZ 제한 없음                                                  | AZ 제한 있음                                          |
|      | 파일수정 가능여부                                 | 불가능(덮어쓰기)                                                                                      | 가능                                                        | 가능                                                |
|      | 비용                                        | 싸다                                                                                             | 비싸다                                                       | 평균                                                |
|      | 사용처                                       | Write once Read many times                                                                     | 빈번한 Read/Wirte                                            | 빈번한 Read/Wirte                                    |
|      | 사용 케이스                                    | 웹 서비스 및 컨텐츠 관리<br/>엔터프라이즈 어플리케이션<br/>홈 디렉토리<br/>데이터베이스 백업<br/>개발자 도구<br/>컨테이너 스토리지<br/>빅데이터 분석 | 웹 서비스 및 컨텐츠 관리<br/>미디어 및 엔터테인먼트 백업<br/>빅데이터분석<br/>데이터 레이크 | 부팅 볼륨<br/>트랜잭션 및 NoSQL 데이터베이스<br/>데이터 웨어하우징 및 ETL |


- 일반적으로 클라우드 기반의 Storage는 3가지 형태로 분류.
  - 1) 파일 스토리지
  - 2) 블록 스토리지
  - 3) 객체 스토리지

- AWS는 블록 스토리지와 객체 스토리지를 중점적으로 제공

#### 파일 스토리지
- 폴더/파일 만으로 구성된 간단한 구조, 파일에 대한 정보 외에 부가적인 데이터(메타 데이터)를 함께 저장하기에는 제한적. 
- 계층의 규모가 커질수록 데이터의 탐색이 느려지고, 자원에 대한 요구가 증가.

#### 블록 스토리지
- EC2를 생성할 때 저장공간으로 사용하는 EBS(Elastic Block Storage)가 대표적인 예.
- 블록(block) 단위로 데이터를 저장하는 스토리지 구조.클라우드 환경에서 자주 사용.
- 데이터를 저장할 때 블록으로 분할한 후, 분할된 블록을 고유한 ID로 구분해 저장. 이 과정에서 블록을 저장할 공간으로 가장 효율적인 스토리지 내 공간을 할당.
- 데이터를 원본 그대로가 아닌 블록 단위로 분할, 독립적으로 저장하는 구조의 특성상 운영체제에 종속적이지 않게 데이터를 저장할 수 있는 장점, 운영체제 또는 환경을 자주 전환하는 클라우드 환경에서 선호되는 방식. 
- 데이터 호출 시에 분할 저장된 블록들을 조합하여 데이터로 돌려주는 구조 덕분에 파일 스토리지에 비해, 탐색 시 더 빠른 효율.
- 블록 단위로 분할하여 저장하는 특성상 스토리지 자체적으로 읽기/쓰기 등의 기능 수행이 불가, 메타데이터를 관리하기 위한 수단이 제한적.

#### 객체 스토리지(Object Storage)
- AWS S3가 대표적
- 저장하는 객체(오브젝트) 단위 그 자체만으로 저장되는 평면적(평면적 = 계층 구조가 없음) 저장구조. 
- 개별 데이터 단위를 데이터 유형의 제약 없이 저장, 파일 시스템이나 색인 등의 일부가 아닌 데이터 자체로 저장되기 때문에 시스템에 독립적. 
- 스토리지 자체 권한 관리가 가능하며 **개별 객체마다 권한을 부여가능**.
- 저장 공간에 대한 확장성이 무한하며(객체 단위로 독립적인 접근이 가능하며), 스토리지의 구조에 따라 다양한 메타 데이터를 객체와 함께 보관가능.
- 블록 단위로 재조합하는 과정이 포함되지 않기 때문에, 매우 큰 크기의 단일 데이터를 저장해야 하는 상황에서 유용하게 활용 가능. 
- OS와 같은 시스템에 독립적.
- 그 자체로 읽기/쓰기가 어려운 블록 스토리지에 비해 저장된 객체 단위로 접근 가능한 경로가 제공되기 쉬운 구조이기 때문에 블록 스토리지와 다르게 **저장된 데이터의 독립적인 url을 제공**.

#### AWS S3의 특성
- 클라우드 기반의 객체 스토리지로써 저장되는 객체마다 독립적인 접근 경로, 권한, 메타데이터를 제공 및 구성가능.
- AWS의 KMS 등을 통해 데이터를 암호화하여 특정 키로 관리가능 
- 객체의 저장 공간에 정해진 크기가 없이, 필요한 만큼 데이터를 무한히 저장가능.
- 메타 데이터를 다양한 형식으로 기록하여, 데이터의 백업, 아카이빙 등을 수동/자동으로 관리할 수 있고, 데이터의 접근 빈도에 따라 여러 등급의 스토리지에 나누어 관리가능.
- S3 Glacier(빙하) 사용 시 자주 사용하지 않는 데이터를 매우 적은 비용으로 클라우드 내에 데이터 보관가능.


#### S3에 대한 걱정
1) 데이터 유실에 대한 우려. 
- S3는 표준 스토리지 기준 99.99999999%(9가 11개)의 데이터 보존을 제공. 
- 100년이 지나도 10억 개 중 1개조차 손실되지 않는 데이터 보존력을 의미. 
- 객체 단위로 강한 복원력을 갖고 있어, 사용자가 실수해도 데이터의 복원 가능. (버전 관리 기능 활용 시)

2) 비용에 대한 걱정. 
- 일반적으로 I/O 성능과 저장공간에 따른 비용 청구가 이루어지는 파일/블록 스토리지와 다르게 S3는 저장된 데이터 공간만큼의 비용 청구가 이루어지며, CDN(CloudFront)와 연계하면 I/O 비용의 획기적 절감 가능.

3) 보안에 대한 우려. 
- S3는 기본적으로 퍼블릭 액세스가 차단되며, 개발자가 원하는 경우 객체 단위로 접근을 허용가능. 
- 객체 암호화 기능을 통해 객체가 노출되더라도 읽을 수 없도록 조치가능.

#### S3 용어
- 버킷(Bucket) : S3에 데이터를 저장하기 위해 생성하는 스토리지 단위. 
  - 스토리지 구성을 어떻게 할지에 따라, 하나의 버킷에 여러 종류의 파일을 보관할 수도, 파일의 종류별로 버킷을 분리도 가능.
- 버킷 버전 관리 : 스토리지에 저장되는 객체들에 대해 버전 관리 기능을 적용하여, 복구, 검색, 복원 등 장애 및 실수를 복구할 수 있는 기능 제공. (활성화 권장)
- ACL: S3에서 객체에 대해 접근 권한을 내 계정 외에 다른 계정에게도 부여가능. (비활성화 권장)

  
---
  
## 1-2. S3(Simple Storage Service)
- 웹에서 사용 가능한 object 저장소
- 뛰어난 내구성, 제약 없는 확장성
- 5가지 유형(Standard, Standard IA, One Zone IA, Glacier, Glacier Deep Archive)

> 사실상 용량 제한이 없으며, 파일 사이즈에 대한 고려 없이 데이터를 S3에 올릴 수 있다. 로그 파일, 정적 휍 호스팅을 위한 파일 등 빈번한 업데이트가 없는 파일(Write few but read many times)을 싼 맛에 올릴 때 용이하게 쓰인다. 하지만 OS나 DB처럼 빠르고 많은 Read/Write 작업이 요구되는 환경에선 추천되지 않는다. 나아가 생각보다 에러도 많고 파일 sync도 맞지 않는 경우도 종종 있다

> S3를 언제 사용하면 좋은가  
> 몇 년 동안 사용하지 않을 수 있는 보고서 및 레코드와 같은 항목은 논의된 다른 두 스토리지 서비스보다 저렴한 비용으로 S3에 저장할 수 있다.  
> 복잡한 쿼리를 실행할 수 있는 데이터를 저장하는 데에도 유용하다.  
> 정적 웹사이트도 지원하므로 여러개의 정적 HTML 페이지를 호스팅해야 하는 경우도 사용하면 좋다.  

## 1-3. EFS (Elastic File Storage)
- AWS 클라우드 서비스와 온프레미스 리소스에서 사용할 수 있는 간단하고 확장 가능하며 탄력적인 완전 관리형 탄력적 NFS 파일 시스템
- 애플리케이션 중단할 필요 없이 확장되므로 사용자가 용량을 프로비저닝 및 관리할 필요 없음
- 최대 수천 개의 EC2 인스턴스를 위한 스토리지이며 동시에 액세스 할 수 있다
- NFSv4(Network File System) 프로토콜 사용
- VPC 내 EC2 인스턴스는 직접 액세스 할 수 있음
- On-premise 서버는 Direct Connect & VPN 연결을 통해 파일 시스템 탑재
  - Direct Connect은 대역폭이 높고 지연 시간이 짧은 전용 네트워크 연결

> S3와 동일하게 사이징 고려 없이 데이터를 올릴 수 있다. 가장 큰 장점은 각기 다양한 서버에서 하나의 파일 시스템으로 데이터를 공유하고 싶을 때 사용될 수 있다는 점이다. EFS는 EBS와 다르게 여러 AZ를 거쳐 복제되어 더 높은 가용성을 자랑한다. 다르게 보자면 EC2가 어느 AZ에 위치하건 마운트가 가능하다(EBS는 안됨). Site-to-Site VPN 혹은 DX로 연결만 되어있으면 On-Premise와도 연결할 수 있다. 사실 돈만 있으면 이게 최고다.  

> EFS는 언제 사용하면 좋은가  
> EFS는 자동 고성능 확장을 통해 여러 EC2 인스턴스에 대한 공유 파일 스토리지 옵션이 필요할 때마다 사용할 수 있다.  따라서 콘텐츠 관리 시스템을 위한 파일 스토리지로 적합하다.  
> 또한 EFS의 공유 가능한 파일 저장소는 코드 및 미디어 파일을 저장하는 데 이상적이기 때문에 응용 프로그램 개발에 적합하기도 하다.  

## 1-4. EBS (Elastic Block Storage)
- AWS EC2 (Elastic Compute Cloud)에서 사용하도록 설게된 사용하기 쉬운 고성능 블록 스토리지 서비스
- AZ(가용 영역)내에서 복제를 통해 재해복구
  - 볼륨의 특정 시점 스냅샷을 S3에 저장가능
  - 마지막 스냅샷 이후 변경된 블록만 저장
  - 비동기적 생성(수정된 블록이 S3로 모두 이동할 때까지 스냅숏 상태는 pending!)
  - 사용 중인 볼륨도 스냅샷 생성가능(단, 루트 디바이스 역할의 EBS볼륨은 인스턴스 중지해야 함)
- 무제한의 확장성, 빠른 복원, 빠른 확장성
- 데이터에 빠르게 액세스하고 장기적으로 지속해야 하는 경우에 적합
- 암호화: 암호화된 볼륨 및 스냅숏 생성 시 AWS KMS(Key Management Service) 고객 마스터 키(CMK) 사용
- EBS 볼륨 유형
  - IOPS(Input Output Operations Per Second) 초당 입출력 작업을 나타냄
  - SSD: 빠름 (64000 IOPS, 16000 IOPS)
  - HDD: 대용량 (500 IOPS, 250 IOPS)

| SSD                  |                     | HDD                      |                 |
|----------------------|---------------------|--------------------------|-----------------|
| Provisioned IOPS SSD | General Purpose SSD | Throughput Optimized HDD | Cold HDD        |
| 지연시간에 민감한 트랜잭션 워크로드  | 다양한 트랜잭션 워크로드       | 자주 엑세스하고 처리량 집약적인 워크로드   | 엑세스 빈도가 낮은 워크로드 |
| 4GB ~ 1TB            | 1GB ~ 16TB          | 500GB ~ 16TB             | 500GB ~ 16TB    |
| 64000 IOPS           | 16000 IOPS          | 500 IOPS                 | 250 IOPS        |  

> EC2에 기본적으로 붙어있는 볼륨 서비스다. Stop 되어도 데이터가 날아가지 않는 지속성을 보이며, 선택한 Type에 따라 다르지만 빠른 Read/Write 속도를 보여준다. 생성 시, 디폴트로 특정 AZ에 배치되어 그곳에서 자동으로 복제되는데, S3의 eleven nines 까진 아니더라도 99.999%의 가용성을 자랑한다. 한번 늘어난 볼륨을 다시 줄일 수 없다.

> EBS는 언제 사용하면 좋은가  
> 단일 인스턴스에 대한 고성능 스토리지 서비스가 필요한 경우 사용한다.  
  
---  
  
  
# 2. CDN (Content Delivery Network or Content Distribution Network)

## 2-1. CDN 특징
- 웹 페이지, 이미지, 동영상 등의 컨텐츠를 본래 서버에서 받아와 캐싱
- 해당 컨텐츠에 대한 요청이 들어오면 캐싱해 둔 컨텐츠를 제공
- 컨텐츠를 제공하는 서버와 실제 요청 지점 간의 지리적 거리가 매우 먼 경우 or 통신 환경이 안좋은 경우 요청지점의 CDN을 통해 빠르게 컨텐츠 제공 가능
- 서버의 요청이 필요 없기 때문에 서버의 부하를 낮추는 효과
 

## 2-2. Edge Location
- 컨텐츠가 캐싱되고 유저에게 제공되는 지점
- AWS가 CDN 을 제공하기 위해서 만든 서비스인 CloudFront의 캐시 서버 (데이터 센터의 전 세계 네트워크)
- cloudFront 서비스는 엣지 로케이션을 통해 콘텐츠를 제공
- CloudFront를 통해 서비스하는 콘텐츠를 사용자가 요청하면 지연 시간이 가장 낮은 엣지 로케이션으로 라우팅되므로 콘텐츠 전송 성능 보장.
- 콘텐츠가 이미 지연 시간이 가장 낮은 엣지 로케이션에 있는 경우 CloudFront가 콘텐츠를 즉시 제공
  
  
---  
  
  
# 3. CloudFront

- 개발자 친화적 환경에서 짧은 지연 시간과 빠른 전송 속도로 데이터, 동영상, 애플리케이션 및 API를 전세계 고객에게 안전하게 전송하는 CDN 서비스
- CloudFront는 CDN 서비스와 이외에도 기본 보안 기능(Anti-DDoS) 제공.

## 3-1. CloudFront 동작방식
- CloudFront는 AWS 백본 네트워크를 통해 콘텐츠를 가장 효과적으로 서비스할 수 있는 엣지로 각 사용자 요청을 라우팅하여 콘텐츠 배포 속도 보장.
- 일반적으로 CloudFront 엣지가 최종 사용자에게 가장 빨리 제공.

#### 콘텐츠가 엣지 로케이션에 없는 경우
- CloudFront는 콘텐츠의 최종 버전에 대한 소스로 지정된 오리진(Amazon S3 버킷, MediaPackge 채널, HTTP 서버(예 : 웹 서버)등) 에서 콘텐츠를 검색
- 컨텐츠를 제공하는 근원에서 제공받아 전달

#### 콘텐츠가 엣지 로케이션에 있는 경우
- 바로 전달
 
## 3-2. CloudFront 데이터 전달 과정

![CloudFront 데이터 전달 과정](./../../images/tech/cloudfront01.png)

- 클라이언트로부터 Edge Server로의 요청이 발생한다.
- Edge Server는 요청이 발생한 데이터에 대하여 캐싱 여부를 확인
- 사용자의 근거리에 위치한 Edge Server 중 캐싱 데이터가 존재한다면 사용자의 요청에 맞는 데이터를 응답, 사용자의 요청에 적합한 데이터가 캐싱되어 있지 않은 경우 Origin Server로 요청이 포워딩
- 요청받은 데이터에 대해 Origin Server에서 획득한 후 Edge Server에 캐싱 데이터를 생성하고, 클라이언트로 응답이 발생

## 3-3. CloudFront 장점
- AWS 네트워크를 사용하면 사용자의 요청이 반드시 통과해야 하는 네트워크의 수가 줄어들어 성능이 향상
- 파일의 첫 바이트를 로드하는 데 걸리는 지연 시간이 줄어들고 데이터 전송 속도가 빨라진다.
- 파일(객체)의 사본이 전 세계 여러 엣지 로케이션에 유지(또는 캐시)되므로 안정성과 가용성이 향상
- 보안성 향상
  - 오리진 서버에 대한 종단 간 연결의 보안이 보장됨(https)
  - 서명된 URL 및 쿠키 사용 옵션으로 자체 사용자 지정 오리진에서 프라이빗 콘텐츠를 제공하도록 할 수 있음

## 3-4. CloudFront + S3를 프론트엔드용 정적서버로 활용

이하의 이유로 정적인 파일을 별도의 EC2 웹 서버에 배포하는 과정 생략가능.
- 웹 서버는 HTTP Method를 통해서 CRUD의 기능을 제공하지만, 웹 서버로부터 필요한 기능은 R.
- S3(Cloud Object Storage, 정적 파일 객체 스토리지)를 통해 R 기능을 만족, 번거로운 설정을 요구하는 웹 서버 필요없음.
- 웹 서버에서 캐싱 기능을 직접 설정해서 사용할 수 있지만, AWS CloudFront(CDN)을 이용해서 AWS에서 제공하는 캐싱으로 대체가능.

## 3-5. CloudFront 기능

### 정적 & 동적 컨텐츠 분별 제공

#### 정적(Static) 컨텐츠
- 서버를 거치지 않고 클라이언트에서 직접 보여주는 내용
  - ex) 이미지, CSS, 기타 서버가 필요없는 내용들
- 캐싱으로 접근속도 최적화

#### 동적(Dynamic) 컨텐츠
- 서버 계산, DB조회 등이 필요한 내용
  - ex) 로그인, 게시판 등
- 네트워크 최적화, 연결 유지, Gzip 압축 등을 사용
- 서버랑 통신을 할 때 전처리 작업이 있는데, 주소가 어디로 전달되는지(DNS Lookup), TCP Connection, Titm to First Byte 등을 CloudFront에서 네트워크를 최적화.
- 실제로 내용을 최적화 해서 보내는 것이 아니라, 통신을 최적화 해서 속도를 최적화 시키는 것

![컨텐츠 최적화](./../../images/tech/cloudfront02.png)

#### 동적 / 정적 컨텐츠 처리
- 경로 패턴으로 URL에 따라 정적/동적 컨텐츠 분기 처리.

![동적 / 정적 컨텐츠 처리](./../../images/tech/cloudfront03.png)

### HTTPS 지원
Origin에서 HTTPS를 지원하지 않더라도 클라우드 프론트내에서 HTTPS 통신을 지원할 수 있도록 구성 가능

예를 들어, S3 정적 웹 호스팅 URL 같은 경우 SSL설정이 쉽지 않은데, CloudFront를 통해서 HTTPS 통신을 지원할수 있게끔 할 수 있다.

HTTPS 지원

### 지리적 제한 설정
특정 지역의 컨텐츠 접근을 제한 가능 하다.

예를들어 아프키라 티비 스트리밍 서비스를 하는데 라이센스나 계약에 따라 일본권에서는 볼 수 있지만, 아프리카권은 볼수 없게 설정 가능하다.

지리적 제한 설정


### 다른 서비스와 연계
- AWS WAF, Lambda@Edge 등과 연동 가능

#### Lambda@Edge
엣지 로케이션에서 돌아가는 람다
람다엣지 사용 사례 :
한국에서 요청이 올 경우 한국 웹서버, 미국에서 요청이 올 경우 미국 웹서버로 분산
커스텀 에러 페이지
Cookie를 검사해 다른 페이지로 리다이렉팅 → A/B 테스팅
CloudFront에서 Origin 도착 이전에 인증 ..등
Lambda@Edge
유저에서 CloudFront 도착하기 전,
CloudFront에서 Origin에 요청 보내기 전,
Origin에서 CloudFront로 응답을 보내기 전,
CloudFront에서 유저한테 응답 보내기 전
이 4단계에서 람다를 실행 해서 이 전달 내용을 변경 할 수 있다.

#### CloudFront Function
Lambda@Edge의 6분의 1 비용으로 경량 javascript 실행
아주 간단한 액션에서만 사용
사용사례 : 캐싱, 헤더 조작 등


## 3-6. CloudFront 정책과 보안

### 1. CloudFront 정책
- CloudFront는 총 3가지 정책 설정 가능.

#### 정책1. 캐시 정책 (Cache Control) : 캐싱 방법 및 압축
TTL 및 Cache Key 정책
CloudFront가 어떻게 캐싱을 할지를 결정
#### 정책2. 원본 요청 정책 (Origin Request) : Origin으로 어떤 내용을 보낼 것인가
Origin에 쿠키, 헤더, 쿼리스트링 중 어떤 것을 보낼 것인가

#### 정책3. 응답 헤더 정책
CloudFront가 응답과 함께 실어 보낼 HTTP Header
CloudFront 정책

### 2. CloudFront 보안
 

Signed URL
어플리케이션에서 CloudFront의 컨텐츠에 접근 할 수 있는 URL을 제공하여 컨텐츠 제공을 제어하는 방법이다.

URL에는 시작시간, 종료시간, IP, 파일명, URL의 유효기간 등의 정보를 담을 수 있음
이 URL 접근 이외의 접근을 막고 허용된 유저에게만 URL을 전달하여 컨텐츠 제공을 제어 가능
단 하나의 파일 또는 컨텐츠에 대한 허용만 가능
S3 Signed URL과 비슷한 방식
Signed URL
 

Signed Cookie
Signed URL은 하나의 컨텐츠만 제공 제어를 한다고 하면, Signed Cookie는 다수의 컨텐츠의 제공방식을 제어하고 싶을 때 사용된다.

Signed URL과 마찬가지로 여러 제약사항 설정 가능
다수의 파일 및 스트리밍 접근 허용 가능
사용사례 : 정기 구독 프리미엄 유저만 볼 수 있는 강의 동영상 등
Signed Cookie
 

Origin Access Identity (OAI)
S3의 컨텐츠를 CloudFront를 사용해서만 볼 수 있도록 제한하는 방법이다.

즉, S3의 정적인 컨텐츠 URL로 바로 접근하는게 아니라 CDN을 통해서 접근하는 것이다. 

왜냐하면 S3로 직접 접속을 하면 캐싱을 못해 속도 측면에서 마이너스가 될수 있고, 국가별 라우팅, 인증 등이 CloudFront에 구현 되어있다면 유저가 직접 S3로 접속하면 안되기 때문이다.

S3는 CloudFront와 잘 맞는다 → 정적인 컨텐츠를 호스팅 하기 때문에 CDN과 찰떡궁합
CloudFront만 권한을 가지고 S3에 접근하고 나머지 접근권한은 막음 → CloudFront는 유저와 S3사이에서 중개하는 역할
S3 Bucket Policy로 CloudFront의 접근을 허용해야 사용 가능
Origin Access Identity (OAI)
 

Field Level Encryption
CloudFront로부터 Origin 사이의 통신을 암호화
최대 10개의 필드까지 가능
공개키 방식으로 암호화 → CloudFront에 공개키를 제공 후 Origin에서 Private Key로 해독

참고사이트 : https://inpa.tistory.com/entry/AWS-%F0%9F%93%9A-CloudFront-%EA%B0%9C%EB%85%90-%EC%9B%90%EB%A6%AC-%EC%82%AC%EC%9A%A9-%EC%84%B8%ED%8C%85-%F0%9F%92%AF-%EC%A0%95%EB%A6%AC

  
---
  
# CLOUDFRONT + LAMBDA@EDGE를 활용한 IMAGE RESIZING

![IMAGE RESIZING](./../../images/tech/imageresize-10.png)

1. URI에 원하는 해상도의 이미지를 요청합니다.
  - ex) https://img.manvscloud.com/image/tom.png?w=200&h=150&f=webp&q=90

2. 캐시 서버(CloudFront/Edge Location)에서 캐싱된 이미지가 있으면 이미지를 전송하지만 캐시된 이미지가 없을 경우 이미지 리사이징 서버(Lambda@Edge)에 API 또는 SDK를 이용한 리사이징된 이미지를 요청합니다.

3. 이미지 리사이징 서버(Lambda@Edge)는 API나 SDK를 통해 이미지가 존재하는 스토리지 서버(S3)에 원본 이미지를 요청하게 됩니다.

4. 스토리지 서버(S3)가 이미지 리사이징 서버(Lambda@Edge)로 이미지를 전송합니다.

5. 이미지 리사이징 서버(Lambda@Edge)는 스토리지 서버(S3)에게 이미지를 받은 후 요청한 URI를 해석한 뒤 원하는 이미지로 리사이징하여 캐시 서버(CloudFront/Edge Location)로 전송합니다.

6. 요청한 해상도의 이미지를 GET 합니다.

- 참조 : https://manvscloud.com/?p=423

---

<details>
  <summary>Exp.</summary>  
  <pre>

  </pre>
</details>